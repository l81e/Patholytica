<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Auto Article Generator</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

const firebaseConfig = {
  apiKey: "YOUR_KEY",
  authDomain: "YOUR_DOMAIN",
  projectId: "YOUR_PROJECT"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

const supabase = window.supabase.createClient(
  "YOUR_SUPABASE_URL",
  "YOUR_SUPABASE_PUBLIC_KEY"
);

let currentUser = null;

onAuthStateChanged(auth, (user) => {
  if (!user) window.location.href = "login.html";
  else currentUser = user;
});

const topics = [
  "AI in Medicine 2026",
  "Latest SpaceX Launch",
  "Global Climate Update",
  "Breakthrough in Cancer Therapy",
  "Cryptocurrency Market Shift",
  "Mental Health in Students",
  "Future of Electric Cars"
];

function generateArticle() {
  const topic = topics[Math.floor(Math.random()*topics.length)];
  const title = topic;
  const content = `
${topic}

This topic is currently trending worldwide.

Experts are discussing its impact on society, economy, and technology.

Further developments are expected soon.
`;

  return { title, content };
}

window.generateAndPublish = async function() {
  if (!currentUser) return alert("Login required");

  const btn = document.getElementById("mainBtn");
  btn.disabled = true;
  btn.innerText = "Generating...";

  const article = generateArticle();

  btn.innerText = "Publishing...";

  const { error } = await supabase.from("articles").insert([{
    title: article.title,
    content: article.content,
    firebase_user_id: currentUser.uid,
    views: 0,
    likes: 0
  }]);

  if (error) {
    alert("Error: " + error.message);
    btn.disabled = false;
    btn.innerText = "Generate Article";
    return;
  }

  alert("Article Published!");
  btn.innerText = "Generate Another";
  btn.disabled = false;
};
</script>
</head>

<body style="display:flex;justify-content:center;align-items:center;height:100vh;background:#111;color:white;font-family:sans-serif;">

<button id="mainBtn" onclick="generateAndPublish()" 
style="padding:20px 40px;font-size:18px;border:none;border-radius:30px;background:#3ea6ff;color:white;cursor:pointer;">
Generate Article
</button>

</body>
</html>